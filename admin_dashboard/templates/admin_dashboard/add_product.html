{% extends 'admin_dashboard/admin_base.html' %}
{% load static %}
  <!-- CSS Libraries -->
  {% block style_reference %}

  <link rel="stylesheet" href=" {% static 'node_modules/bootstrap-daterangepicker/daterangepicker.css' %} ">
  <link rel="stylesheet" href=" {% static 'node_modules/bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css' %} ">
  <link rel="stylesheet" href=" {% static 'node_modules/select2/dist/css/select2.min.css' %} ">
  <link rel="stylesheet" href=" {% static 'node_modules/selectric/public/selectric.css' %} ">
  <link rel="stylesheet" href=" {% static 'node_modules/bootstrap-timepicker/css/bootstrap-timepicker.min.css' %} ">
  <link rel="stylesheet" href=" {% static 'node_modules/bootstrap-tagsinput/dist/bootstrap-tagsinput.css' %} ">
  <link rel="stylesheet" href=" {% static 'node_modules/dropzone/dist/min/dropzone.min.css' %} ">

  <style>
    .cke{
      width: 100% !important;
    }
    .django-ckeditor-widget{
      width: 100% !important;
      max-height: 500px;
    }

  </style>
  {% endblock %}
  


      
      
      

      <!-- Main Content -->
      
        {% block content %}
          <section class="section">
            <div class="section-header">
              <h1>Advanced Forms</h1>
              <div class="section-header-breadcrumb">
                <div class="breadcrumb-item active"><a href="#">Dashboard</a></div>
                <div class="breadcrumb-item"><a href="#">Forms</a></div>
                <div class="breadcrumb-item">Advanced Forms</div>
              </div>
            </div>

            <div class="section-body">
              

              <div class="row justify-content-center">
                <form method="POST" action="" enctype="multipart/form-data" id="form_container">
                  {% csrf_token %}
                  {{product_form.media}}
                  
                  <div class="col-12 col-xxl-8">
                    <div class="card">
                      
                      <div class="card-header">
                        <h4>Add New Product</h4>
                      </div>
                      <div class="card-body">
                        <div class="form-group">
                          <label>Product Name</label>
                          <!-- <input type="text" class="form-control"> -->
                          {{product_form.name}}
                        </div>
                        <label>Description</label>
                        <div class="form-group">
                          
                          <!-- <input type="text" class="form-control"> -->
                          {{product_form.description}}
                        </div>
                       
                        <div class="form-group">
                          <label>General Price</label>
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <div class="input-group-text">
                                &#8377;
                              </div>
                            </div>
                            {{product_form.general_price}}
                          </div>
                        </div>
                        
                        
                        <div class="form-group">
                          <label>Status</label>
                          {{product_form.status}}
                          
                        </div>
                        <div class="form-group">
                          <label>Tags</label>
                          {{product_form.tags}}
                        </div>
                        
                        
                      </div>
                    </div>
                   
                        
                        
                      
                        {{ formset.management_form }}
                        <div>
                          {% for form in formset %}
                            {% for hidden in form.hidden_fields %}
                              {{ hidden }}
                            {% endfor %}
                              <div class="card variant_form" style="display: none;" id="{{forloop.counter}}_variant_form" >
                                <div class="card-header d-flex justify-content-between">
                                  <h4>Variant - {{forloop.counter}}</h4>
                                  <a href="#" class="btn btn-icon btn-danger"><i class="fas fa-times"></i></a>
                                </div>
                                <div class="card-body">
                                  <div class="row mb-4 w-100" >
                                    
                                    
                                    <div class="form-group col-12 col-md-4">
                                      <label>Variant Type</label>
                                      {{form.variant_type}}
                                    </div>
                                    <div class="form-group col-12 col-md-4">
                                      <label>Variant Name</label>
                                      {{form.variant_name}}
                                    </div>
                                    <!-- <div class="form-group col-12 col-md-4">
                                      <label>Value</label>
                                      {{form.value}}
                                    </div> -->
                                    <div class="form-group col-12 col-md-4" id="{{forloop.counter0}}-colorpicker" style="display:none;">
                                      <label>Pick Your Color</label>
                                      <div class="input-group colorpickerinput">
                                        {{form.value}}
                                        <div class="input-group-append">
                                          <div class="input-group-text">
                                            <i class="fas fa-fill-drip"></i>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="form-group col-12 col-md-4">
                                      <label>Total Stock</label>
                                      {{form.total_stock}}
                                    </div>
                                    <div class="form-group col-12 col-md-4">
                                      <label>Availabe Stock</label>
                                      {{form.available_stock}}
                                    </div>
          
                                    <div class="form-group col-12 col-md-4">
                                      <label>Original Price</label>
                                      <div class="input-group">
                                        <div class="input-group-prepend">
                                          <div class="input-group-text">
                                            &#8377;
                                          </div>
                                        </div>
                                        {{form.original_price}}
                                      </div>
                                    </div>
          
                                    <div class="form-group col-12 col-md-4">
                                      <label>Current Price</label>
                                      <div class="input-group">
                                        <div class="input-group-prepend">
                                          <div class="input-group-text">
                                            &#8377;
                                          </div>
                                        </div>
                                        {{form.current_price}}
                                      </div>
                                    </div>
                                    <div class="col-12">
                                      <label>Description</label>
                                      <div class="form-group">                                        
                                        {{form.description}}
                                      </div>
                                    </div>
                                    
                                    <div class="col-12" style="padding-left: 15px; padding-right:15px;">
                                      <div class="dropzone mydropzone " id="mydropzone" name="dropzone" >
                                        <div class="fallback">
                                          {{form.images}}
                                        </div>
                                      </div>
                                    </div>
                                    
                                  </div>

                                </div>
                          
                       
                              </div>
                         
                         
                        {% endfor %}
                        </div>
                        <div class="add-btn-conatiner d-flex w-100 justify-content-end mb-4">
                          <button  class="btn btn-warning" id="add_button" onclick="add_button_handler(event);" style="left: 0px;">+ Add Variant</button>
                          <button class="btn btn-success ml-4" type="submit" >Submit</button>

                        </div>

                        
                    
                    
                    
</div>
                  
                </form>
                
              </div>
            </div>
          </section>


        
        {% endblock %}
      
     
  


  <!-- JS Libraies -->
  {% block script_reference %}
    <script src=" {% static 'node_modules/cleave.js/dist/cleave.min.js' %} "></script>
    <script src=" {% static 'node_modules/cleave.js/dist/addons/cleave-phone.us.js' %} "></script>
    <script src=" {% static 'node_modules/jquery-pwstrength/jquery.pwstrength.min.js' %} "></script>
    <script src=" {% static 'node_modules/bootstrap-daterangepicker/daterangepicker.js' %} "></script>
    <script src=" {% static 'node_modules/bootstrap-colorpicker/dist/js/bootstrap-colorpicker.min.js' %} "></script>
    <script src=" {% static 'node_modules/bootstrap-timepicker/js/bootstrap-timepicker.min.js' %} "></script>
    <script src=" {% static 'node_modules/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js' %} "></script>
    <script src=" {% static 'node_modules/select2/dist/js/select2.full.min.js' %} "></script>
    <script src=" {% static 'node_modules/selectric/public/jquery.selectric.min.js' %} "></script>
    <script src=" {% static 'node_modules/dropzone/dist/min/dropzone.min.js' %} "></script>
  {% endblock %}
  

  

  <!-- Page Specific JS File -->
  {% block specific_script_reference %}
    <script src=" {% static 'assets/js/page/forms-advanced-forms.js' %} "></script>
    <script src=" {% static 'assets/js/page/components-multiple-upload.js' %}"></script>
    <script>
      let form_container=document.getElementById("form_container");
      let add_button=document.getElementById("add_button");
      let variant_forms=document.querySelectorAll(".variant_form")
      let current_active=0;

      let variant_forms_length=variant_forms.length-1;
      variant_forms[0].style.display="flex";
      console.log(variant_forms_length);

      
      
      for(let i=0;i<variant_forms_length;i++){
        $(`#id_form-${i}-variant_type`).on('select2:select', function (e) {
          var data = e.params.data;
          if (data.text==='color'){
            let color_picker_div=document.getElementById(`${i}-colorpicker`);
            color_picker_div.style.display='block';
          }
          else{
            
          }
        });
        
      }

      const add_button_handler=(event)=>{
        event.preventDefault();
        //let previous_input_field=document.getElementById(`id_questions-${current_active}-qn_name`)
        //if(previous_input_field.value===''){
            //DisplayCustomMessage(`Question-${current_active+1} is empty`,'warning');
            //return
        //}
        if (variant_forms[current_active])
        if(current_active<variant_forms_length){
            current_active+=1;
            variant_forms[current_active].style.display="flex";
            //variant_forms[current_active].getElementsByClassName("qn_num_span")[0].innerHTML=current_active+1
        }
        else{
            //DisplayCustomMessage("Question limit reached","info");
        }
        
     }
        
    

    </script>
  {% endblock %}

